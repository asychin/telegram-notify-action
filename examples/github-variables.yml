name: GitHub Variables Demo

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]
  workflow_dispatch:

jobs:
  github-variables-demo:
    name: GitHub Variables Demo
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: üöÄ Demo –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        uses: ./
        with:
          telegram_token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          chat_id: ${{ secrets.TELEGRAM_CHAT_ID }}
          template: success
          parse_mode: "Markdown"
          message: |
            üéØ **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è GitHub –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**

            üè† **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
            ‚Ä¢ –ü–æ–ª–Ω–æ–µ –∏–º—è: `{{repository}}`
            ‚Ä¢ –¢–æ–ª—å–∫–æ –∏–º—è: `{{repositoryName}}`
            ‚Ä¢ –í–ª–∞–¥–µ–ª–µ—Ü: `{{repositoryOwnerName}}`

            üîó **–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**
            ‚Ä¢ [–ö–æ–º–º–∏—Ç]({{commitUrl}}) (`{{shortSha}}`)
            ‚Ä¢ [–¢–µ–∫—É—â–∏–π run]({{runUrl}}) (#{{runNumber}})
            ‚Ä¢ [Workflow]({{workflowUrl}})
            ‚Ä¢ [Issues]({{issuesUrl}}) | [PRs]({{pullRequestsUrl}}) | [Releases]({{releasesUrl}})

            üìä **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
            ‚Ä¢ –í–µ—Ç–∫–∞: `{{refName}}` ({{refType}})
            ‚Ä¢ Runner: {{runnerOs}}/{{runnerArch}}
            ‚Ä¢ –ü–æ–ø—ã—Ç–∫–∞: {{runAttempt}}
            ‚Ä¢ Job ID: {{jobId}}
          template_vars: |
            {
              "customMessage": "–í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ template_vars!"
            }
          inline_keyboard: |
            [
              {"text": "üìä Workflow", "url": "${{ github.server_url }}/${{ github.repository }}/actions"},
              {"text": "üîó –ö–æ–º–º–∏—Ç", "url": "${{ github.server_url }}/${{ github.repository }}/commit/${{ github.sha }}"},
              {"text": "üèÉ Run", "url": "${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"}
            ]

      - name: üìù –î–µ–º–æ —à–∞–±–ª–æ–Ω–∞ —Å –≤—ã—á–∏—Å–ª—è–µ–º—ã–º–∏ URL
        uses: ./
        with:
          telegram_token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          chat_id: ${{ secrets.TELEGRAM_CHAT_ID }}
          template: info
          parse_mode: "Markdown"
          message: |
            üí° **–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ URL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**

            –í–º–µ—Å—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Ç–∏–ø–∞:
            ```
            ${{ github.server_url }}/${{ github.repository }}/commit/${{ github.sha }}
            ```

            –ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
            ```
            {{commitUrl}}
            ```

            üìã **–î–æ—Å—Ç—É–ø–Ω—ã–µ URL –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
            ‚Ä¢ `{{commitUrl}}` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –∫–æ–º–º–∏—Ç
            ‚Ä¢ `{{runUrl}}` - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ç–µ–∫—É—â–∏–π run
            ‚Ä¢ `{{workflowUrl}}` - —Å—Å—ã–ª–∫–∞ –Ω–∞ workflow
            ‚Ä¢ `{{compareUrl}}` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–∞–∑–æ–≤–æ–π –≤–µ—Ç–∫–æ–π
            ‚Ä¢ `{{issuesUrl}}` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ issues
            ‚Ä¢ `{{pullRequestsUrl}}` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ pull requests  
            ‚Ä¢ `{{releasesUrl}}` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ releases

            ‚ú® **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏:**
            ‚Ä¢ `{{shortSha}}` - –∫–æ—Ä–æ—Ç–∫–∏–π SHA –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–≥–æ
            ‚Ä¢ `{{repositoryName}}` - —Ç–æ–ª—å–∫–æ –∏–º—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
            ‚Ä¢ `{{repositoryOwnerName}}` - —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü

      - name: üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        uses: ./
        with:
          telegram_token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          chat_id: ${{ secrets.TELEGRAM_CHAT_ID }}
          template: deploy
          parse_mode: "Markdown"
          message: |
            üõ†Ô∏è **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ä–µ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

            **üñ•Ô∏è Runner:**
            ‚Ä¢ OS: {{runnerOs}}
            ‚Ä¢ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: {{runnerArch}}
            ‚Ä¢ –ò–º—è: {{runnerName}}
            ‚Ä¢ –°—Ä–µ–¥–∞: {{runnerEnvironment}}

            **üìÅ –ü—É—Ç–∏:**
            ‚Ä¢ Workspace: {{workspace}}
            ‚Ä¢ Temp: {{runnerTemp}}
            ‚Ä¢ Tool Cache: {{runnerToolCache}}

            **üîß GitHub Action:**
            ‚Ä¢ Action Path: {{actionPath}}
            ‚Ä¢ Action Ref: {{actionRef}}
            ‚Ä¢ Action Repository: {{actionRepository}}

            **üìä Workflow:**
            ‚Ä¢ Workflow Ref: {{workflowRef}}
            ‚Ä¢ Workflow SHA: {{workflowSha}}
            ‚Ä¢ Retention Days: {{retentionDays}}
          template_vars: |
            {
              "deployStatus": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π"
            }
